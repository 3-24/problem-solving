IN:
1 2 4
2
1 1 2
2 2 3
OUT:
16 0
0 81

IN:
3 4 5
4
1 2 1
2 3 1
3 4 1
4 1 1
4
1 1 2
2 3 1
3 4 1
4 2 1
5
1 2 1
2 4 1
4 3 1
3 1 1
1 4 1
OUT:
0 0 1 0
0 1 0 0
2 0 0 0
4 0 0 2

IN:
1 8 3
12
1 2 1
1 8 1
2 3 1
2 8 1
3 4 1
3 7 1
3 8 1
4 5 1
4 7 1
5 6 1
6 7 1
7 8 1
OUT:
0 0 0 1 0 0 1 1
0 0 0 0 1 0 1 1
0 0 0 0 0 1 0 1
0 0 0 0 0 0 1 0
0 0 0 0 0 0 0 1
0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0
0 0 0 0 0 0 0 0

IN:
1 8 100000000
24
1 2 1
1 8 1
2 1 1
2 3 1
2 8 1
3 2 1
3 4 1
3 7 1
3 8 1
4 3 1
4 5 1
4 7 1
5 4 1
5 6 1
6 5 1
6 7 1
7 3 1
7 4 1
7 6 1
7 8 1
8 1 1
8 2 1
8 3 1
8 7 1
OUT:
261245548 769313318 167840464 862450688 445583828 270525651 828293276 976953408
769313318 542054741 65223362 957807341 63263610 545566670 134857214 863984679
167840464 65223362 959076197 916983285 988077461 199284746 461375786 371787307
862450688 957807341 916983285 119640157 267995930 978327505 847171719 483910227
445583828 63263610 988077461 267995930 394594439 718634258 715295769 69712722
270525651 545566670 199284746 978327505 718634258 131562703 197248645 728310434
828293276 134857214 461375786 847171719 715295769 197248645 322189612 142912983
976953408 863984679 371787307 483910227 69712722 728310434 142912983 162707920